#!/usr/bin/tclsh

set d1 "m 42.7387,63.325 c -0.998,-2.7004 -2.8125,-4.991 -4.4475,-7.3283 -2.1887,1.8509 -4.4161,4.0535 -7.3437,4.5541 -1.5697,0.062 -2.2376,-1.3014 -0.4242,-1.7503 2.2029,-1.4421 4.2785,-3.0832 6.175,-4.9103 -1.8003,-2.2983 -3.5866,-4.6077 -5.4069,-6.8902 5.2183,-0.062 10.4764,-0.3735 15.6677,-0.3329 -0.8568,0.9164 -1.4954,2.8208 -2.974,2.6889 -2.1911,0.097 -4.4106,0.033 -6.5675,0.4546 2.5959,3.2538 6.0035,6.068 7.8078,9.9325 0.6742,1.117 0.1687,2.0053 -0.8383,2.5538 -0.4738,0.229 -1.2568,1.3545 -1.6484,1.0281 z m -18.569,-1.1049 c -1.4094,-3.6263 -2.8091,-7.2565 -4.1891,-10.8941 0.7543,-1.3046 1.3062,0.133 1.828,0.7741 0.9944,1.1489 1.9723,4.0059 3.5472,1.761 2.2231,-1.9639 3.2993,-4.8051 4.1505,-7.5611 1.2935,3.199 1.556,7.203 -0.8375,9.9742 -1.4305,1.8228 -3.3629,3.543 -3.4328,6.0378 -0.2826,0.2157 -0.9894,0.4783 -1.0663,-0.092 z m -1.6336,-11.7301 c -0.6093,-0.9137 1.1707,-2.1084 1.3384,-3.1993 0.6081,-1.1949 1.5724,-2.4905 -0.4309,-2.2031 -1.0194,-0.5484 -4.0475,-2.9571 -1.1348,-2.3068 1.9386,0.2507 4.0913,0.5163 4.1609,-2.0319 1.3162,-2.0364 -1.7527,-0.075 -1.6915,-1.6543 0.2512,-0.6764 1.5788,-0.9426 2.2135,-1.473 1.4749,-0.6089 3.9618,-2.6994 4.8237,-2.4546 -0.9622,2.6873 -2.2579,5.2615 -3.2991,7.9006 1.2598,1.2796 -1.8335,1.5775 -1.8423,3.1547 -1.0919,1.3958 -2.4339,4.4325 -4.1379,4.2677 z m 8.993,-4.96 c 0.07,-1.5861 1.6215,-4.2909 1.6775,-6.3529 0.2509,-1.4521 -0.1866,-3.478 1.9651,-2.5548 2.3993,0.1652 4.7985,0.3337 7.1992,0.4774 -0.5289,1.9146 -1.6233,3.7423 -1.6991,5.7865 0.84,1.0277 3.2106,0.4312 3.5278,1.5374 -0.093,1.3625 -2.7125,0.3895 -3.7399,0.8206 -1.0883,0.1009 -3.5062,0.3932 -3.0308,-1.3508 -0.026,-1.5818 1.6101,-4.2327 -1.0281,-3.6342 -0.9697,0.4649 -1.0055,2.3543 -1.856,3.1893 -0.6592,1.0176 -1.5996,2.4356 -3.0157,2.0815 z m -20.1189,-1.7628 c -0.2007,-1.352 2.4944,-1.9231 3.2489,-3.0604 2.5219,-2.0801 4.9,-4.3511 6.9553,-6.8984 -1.0792,-1.1812 -2.1848,-2.3391 -3.2324,-3.5486 0.2924,-1.4452 1.3189,-0.3182 2.0441,0.075 0.8413,0.5214 1.6826,1.0429 2.5239,1.5643 1.4532,-1.958 2.6854,-4.1114 3.6479,-6.3501 -1.1911,-0.6479 -5.0092,-1.9764 -1.9139,-3.2085 2.1635,-0.8804 4.8286,-1.0343 5.983,1.4192 1.2833,1.0399 2.4989,4.4763 3.9649,1.9604 0.9531,-0.9351 1.1055,-2.3989 1.7038,-3.5683 0.7441,-1.3293 1.0731,-3.9055 2.1241,-4.3264 3.8257,2.6661 7.876,5.1593 11.0579,8.608 1.3526,3.1593 -3.1523,0.347 -4.3924,-0.2487 -1.66,-0.204 -4.0519,-3.8467 -5.0238,-1.3267 -0.1607,0.8248 -1.7442,1.8754 -0.7336,2.5335 2.0753,1.5343 4.1315,3.0445 6.3443,4.3748 4.2952,2.6309 8.8566,5.2889 13.9276,5.9074 0.022,2.0064 -3.6717,1.765 -5.2078,2.8054 -1.8109,0.6385 -3.6224,1.2755 -5.4324,1.9169 -3.6983,-3.6008 -7.411,-7.187 -11.077,-10.8208 -2.4984,0.983 -4.9893,1.9851 -7.4969,2.9445 -1.3257,-0.7868 0.1782,-1.2437 0.8565,-1.7051 1.5275,-0.972 3.1645,-1.8306 4.5857,-2.9232 -0.6419,-0.4117 -1.6964,-2.4734 -2.3937,-1.8828 -5.5558,7.1602 -12.7745,13.6123 -21.6634,16.1164 -0.3124,0.1966 -0.2675,-0.1823 -0.4006,-0.3578 z"

set d2 "m 37.35,55.3395 c -0.28,-0.5884 -1.6624,-1.2083 -0.3429,-1.4393 0.7916,-0.9146 1.5456,-1.8283 2.5118,-2.5828 1.1806,-1.1506 2.3262,-2.3528 3.1244,-3.8097 0.4062,-0.4147 0.8482,-0.95 1.4906,-0.8318 0.9983,-0.036 1.9967,-0.072 2.995,-0.1079 -2.0821,2.6357 -4.388,5.1032 -6.8648,7.3707 -0.9445,0.4343 -1.6967,1.8555 -2.6109,1.7967 -0.025,-0.1539 -0.3035,-0.2295 -0.3032,-0.3959 z m 0.7,-24.456 c -0.7214,-0.3823 -2.4501,-1.203 -0.896,-1.7513 1.176,-0.7135 2.4142,-1.3202 3.4941,-2.1832 1.3606,-0.8078 2.6094,-1.8015 4.0168,-2.5251 0.6321,-0.3057 1.307,-0.5024 1.9738,-0.7149 1.2022,1.0084 2.4825,2.0216 3.2852,3.3842 0.2727,1.4719 -1.9944,0.8245 -2.8343,1.2452 -2.0691,0.5086 -4.1008,1.1651 -6.0504,2.0255 -1.0493,0.1566 -2.0093,1.3824 -2.9892,0.5196 l 0,0 z"

proc filter {d} {
    set d [split $d {}]
    puts [llength $d]
    set dout {}
    set num {}
    for {set i 0} {$i < [llength $d]} {incr i} {
	set c [lindex $d $i]
	switch -regexp -- $c {
	    {^[lmchvz ,]$} {
		# single character plotting, spacing, and separator
		if {$num ne {}} {
		    append dout [format %.2f $num]
		    set num {}
		}
		append dout $c
	    }
	    {^[0123456789]$} {
		append num $c
	    }
	    {^[-]$} {
		if {$num eq {}} {
		    append num $c
		} else {
		    append dout [format %.2f $num]
		    set num {-}
		}
	    }
	    {^[.]$} {
		if {[regexp {^-?\d+$} $num]} {
		    append num $c
		} else {
		    append dout [format %.2f $num]
		    set num {.}
		}
	    }
	    default {
		error "found {$c} in string"
	    }
	}
    }
    return $dout
}

foreach d [list $d1 $d2] {
    puts "before [string length $d] after [string length [filter $d]]"
}
#puts [filter $d1]
#puts [filter $d2]
